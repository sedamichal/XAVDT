# JAK ODHADNOUT Î²â‚€ A Î²â‚ - JEDNODUCHÃ LINEÃRNÃ REGRESE

## MODEL

Pro **jednoduchÃ½ lineÃ¡rnÃ­ model** s jednÃ­m regresorem:

```
yáµ¢ = Î²â‚€ + Î²â‚Â·xâ‚áµ¢ + Îµáµ¢
```

HledÃ¡me odhady **bâ‚€** a **bâ‚**, kterÃ© minimalizujÃ­ souÄet ÄtvercÅ¯ chyb (RSS).

---

## METODA NEJMENÅ ÃCH ÄŒTVERCÅ® (OLS)

### CÃ­l: Minimalizovat RSS

```
RSS = Î£(yáµ¢ - Å·áµ¢)Â²
RSS = Î£(yáµ¢ - bâ‚€ - bâ‚Â·xâ‚áµ¢)Â²
```

---

## ODVOZENÃ VZORCÅ®

### Krok 1: Derivace podle bâ‚€

```
âˆ‚RSS/âˆ‚bâ‚€ = -2Â·Î£(yáµ¢ - bâ‚€ - bâ‚Â·xâ‚áµ¢) = 0
```

Ãšprava:
```
Î£yáµ¢ - nÂ·bâ‚€ - bâ‚Â·Î£xâ‚áµ¢ = 0
nÂ·bâ‚€ = Î£yáµ¢ - bâ‚Â·Î£xâ‚áµ¢
bâ‚€ = (Î£yáµ¢)/n - bâ‚Â·(Î£xâ‚áµ¢)/n
```

**VÃ½sledek:**
```
bâ‚€ = È³ - bâ‚Â·xÌ„â‚
```

### Krok 2: Derivace podle bâ‚

```
âˆ‚RSS/âˆ‚bâ‚ = -2Â·Î£xâ‚áµ¢(yáµ¢ - bâ‚€ - bâ‚Â·xâ‚áµ¢) = 0
```

Po dosazenÃ­ bâ‚€ = È³ - bâ‚Â·xÌ„â‚ a ÃºpravÄ›:

```
Î£xâ‚áµ¢(yáµ¢ - È³ + bâ‚Â·xÌ„â‚ - bâ‚Â·xâ‚áµ¢) = 0
Î£xâ‚áµ¢(yáµ¢ - È³) = bâ‚Â·Î£xâ‚áµ¢(xâ‚áµ¢ - xÌ„â‚)
```

**VÃ½sledek:**
```
bâ‚ = Î£(xâ‚áµ¢ - xÌ„â‚)(yáµ¢ - È³) / Î£(xâ‚áµ¢ - xÌ„â‚)Â²
```

---

## VZORCE PRO VÃPOÄŒET

### Vzorec 1: PomocÃ­ kovariance

```
bâ‚ = Cov(Xâ‚, Y) / Var(Xâ‚)
bâ‚ = sâ‚“â‚y / sÂ²â‚“â‚
bâ‚€ = È³ - bâ‚Â·xÌ„â‚
```

### Vzorec 2: PomocÃ­ korelace

```
bâ‚ = rÂ·(sáµ§/sâ‚“â‚)
bâ‚€ = È³ - bâ‚Â·xÌ„â‚
```

kde:
- **r** = korelaÄnÃ­ koeficient mezi Xâ‚ a Y
- **sáµ§** = smÄ›rodatnÃ¡ odchylka Y
- **sâ‚“â‚** = smÄ›rodatnÃ¡ odchylka Xâ‚

### Vzorec 3: PÅ™Ã­mÃ½ vÃ½poÄet (nejÄastÄ›jÅ¡Ã­)

```
bâ‚ = [Î£(xâ‚áµ¢Â·yáµ¢) - nÂ·xÌ„â‚Â·È³] / [Î£(xâ‚áµ¢Â²) - nÂ·xÌ„â‚Â²]

bâ‚€ = È³ - bâ‚Â·xÌ„â‚
```

---

## PRAKTICKÃ PÅ˜ÃKLAD - KROK ZA KROKEM

### Data z naÅ¡eho pÅ™Ã­kladu

MÃ¡me **n = 50** domÅ¯, ukÃ¡Å¾eme vÃ½poÄet na **zjednoduÅ¡enÃ½ch datech** (prvnÃ­ch 10):

| i | Cena Y (mil.) | Plocha Xâ‚ (mÂ²) |
|---|---------------|----------------|
| 1 | 3.2 | 85 |
| 2 | 5.1 | 120 |
| 3 | 4.8 | 110 |
| 4 | 6.2 | 145 |
| 5 | 3.9 | 95 |
| 6 | 7.1 | 165 |
| 7 | 4.5 | 105 |
| 8 | 5.8 | 135 |
| 9 | 2.8 | 75 |
| 10 | 6.5 | 155 |

---

## METODA 1: POMOCÃ KOVARIANCE

### Krok 1: SpoÄÃ­tat prÅ¯mÄ›ry

```
È³ = (3.2 + 5.1 + 4.8 + ... + 6.5) / 10
È³ = 50.0 / 10 = 5.0 mil.

xÌ„â‚ = (85 + 120 + 110 + ... + 155) / 10
xÌ„â‚ = 1190 / 10 = 119 mÂ²
```

### Krok 2: SpoÄÃ­tat kovarianci

```
Cov(Xâ‚, Y) = Î£(xâ‚áµ¢ - xÌ„â‚)(yáµ¢ - È³) / (n-1)
```

**Tabulka odchylek:**

| i | yáµ¢ - È³ | xâ‚áµ¢ - xÌ„â‚ | (xâ‚áµ¢ - xÌ„â‚)(yáµ¢ - È³) |
|---|--------|----------|---------------------|
| 1 | -1.8 | -34 | 61.2 |
| 2 | 0.1 | 1 | 0.1 |
| 3 | -0.2 | -9 | 1.8 |
| 4 | 1.2 | 26 | 31.2 |
| 5 | -1.1 | -24 | 26.4 |
| 6 | 2.1 | 46 | 96.6 |
| 7 | -0.5 | -14 | 7.0 |
| 8 | 0.8 | 16 | 12.8 |
| 9 | -2.2 | -44 | 96.8 |
| 10 | 1.5 | 36 | 54.0 |

```
Î£(xâ‚áµ¢ - xÌ„â‚)(yáµ¢ - È³) = 387.9

Cov(Xâ‚, Y) = 387.9 / 9 = 43.1
```

### Krok 3: SpoÄÃ­tat rozptyl Xâ‚

```
Var(Xâ‚) = Î£(xâ‚áµ¢ - xÌ„â‚)Â² / (n-1)
```

**Tabulka ÄtvercÅ¯ odchylek:**

| i | (xâ‚áµ¢ - xÌ„â‚)Â² |
|---|-------------|
| 1 | 1156 |
| 2 | 1 |
| 3 | 81 |
| 4 | 676 |
| 5 | 576 |
| 6 | 2116 |
| 7 | 196 |
| 8 | 256 |
| 9 | 1936 |
| 10 | 1296 |

```
Î£(xâ‚áµ¢ - xÌ„â‚)Â² = 8290

Var(Xâ‚) = 8290 / 9 = 921.1
```

### Krok 4: VypoÄÃ­tat bâ‚

```
bâ‚ = Cov(Xâ‚, Y) / Var(Xâ‚)
bâ‚ = 43.1 / 921.1
bâ‚ = 0.0468 â‰ˆ 0.047
```

### Krok 5: VypoÄÃ­tar bâ‚€

```
bâ‚€ = È³ - bâ‚Â·xÌ„â‚
bâ‚€ = 5.0 - 0.047 Ã— 119
bâ‚€ = 5.0 - 5.59
bâ‚€ = -0.59
```

### âœ… VÃ½sledek - Metoda 1

```
Å· = -0.59 + 0.047Ã—plocha
```

---

## METODA 2: POMOCÃ KORELACE

### Krok 1: SpoÄÃ­tat smÄ›rodatnÃ© odchylky

```
sáµ§ = âˆš[Î£(yáµ¢ - È³)Â² / (n-1)]
```

**Tabulka ÄtvercÅ¯ odchylek Y:**

| i | (yáµ¢ - È³)Â² |
|---|-----------|
| 1 | 3.24 |
| 2 | 0.01 |
| 3 | 0.04 |
| 4 | 1.44 |
| 5 | 1.21 |
| 6 | 4.41 |
| 7 | 0.25 |
| 8 | 0.64 |
| 9 | 4.84 |
| 10 | 2.25 |

```
Î£(yáµ¢ - È³)Â² = 18.33

sáµ§ = âˆš(18.33 / 9) = âˆš2.037 = 1.427
```

```
sâ‚“â‚ = âˆš(921.1) = 30.35
```

### Krok 2: SpoÄÃ­tat korelaci

```
r = Cov(Xâ‚, Y) / (sâ‚“â‚ Ã— sáµ§)
r = 43.1 / (30.35 Ã— 1.427)
r = 43.1 / 43.31
r = 0.995
```

Nebo pÅ™Ã­mo:
```
r = Î£(xâ‚áµ¢ - xÌ„â‚)(yáµ¢ - È³) / âˆš[Î£(xâ‚áµ¢ - xÌ„â‚)Â² Ã— Î£(yáµ¢ - È³)Â²]
r = 387.9 / âˆš(8290 Ã— 18.33)
r = 387.9 / 389.7
r = 0.995
```

### Krok 3: VypoÄÃ­tat bâ‚

```
bâ‚ = r Ã— (sáµ§ / sâ‚“â‚)
bâ‚ = 0.995 Ã— (1.427 / 30.35)
bâ‚ = 0.995 Ã— 0.047
bâ‚ = 0.047
```

### Krok 4: VypoÄÃ­tat bâ‚€

```
bâ‚€ = È³ - bâ‚Â·xÌ„â‚
bâ‚€ = 5.0 - 0.047 Ã— 119
bâ‚€ = -0.59
```

### âœ… VÃ½sledek - Metoda 2

```
Å· = -0.59 + 0.047Ã—plocha
```

âœ… **StejnÃ½ vÃ½sledek jako Metoda 1!**

---

## METODA 3: PÅ˜ÃMÃ VÃPOÄŒET

### PomocnÃ¡ tabulka

| i | yáµ¢ | xâ‚áµ¢ | xâ‚áµ¢Â·yáµ¢ | xâ‚áµ¢Â² |
|---|-----|------|--------|------|
| 1 | 3.2 | 85 | 272 | 7225 |
| 2 | 5.1 | 120 | 612 | 14400 |
| 3 | 4.8 | 110 | 528 | 12100 |
| 4 | 6.2 | 145 | 899 | 21025 |
| 5 | 3.9 | 95 | 371 | 9025 |
| 6 | 7.1 | 165 | 1172 | 27225 |
| 7 | 4.5 | 105 | 473 | 11025 |
| 8 | 5.8 | 135 | 783 | 18225 |
| 9 | 2.8 | 75 | 210 | 5625 |
| 10 | 6.5 | 155 | 1008 | 24025 |
| **Î£** | **50.0** | **1190** | **6328** | **149900** |

### Krok 1: VypoÄÃ­tat bâ‚

```
bâ‚ = [Î£(xâ‚áµ¢Â·yáµ¢) - nÂ·xÌ„â‚Â·È³] / [Î£(xâ‚áµ¢Â²) - nÂ·xÌ„â‚Â²]
```

**ÄŒitatel:**
```
Î£(xâ‚áµ¢Â·yáµ¢) - nÂ·xÌ„â‚Â·È³ = 6328 - 10 Ã— 119 Ã— 5.0
                     = 6328 - 5950
                     = 378
```

**Jmenovatel:**
```
Î£(xâ‚áµ¢Â²) - nÂ·xÌ„â‚Â² = 149900 - 10 Ã— 119Â²
                  = 149900 - 10 Ã— 14161
                  = 149900 - 141610
                  = 8290
```

**VÃ½sledek:**
```
bâ‚ = 378 / 8290 = 0.0456 â‰ˆ 0.046
```

### Krok 2: VypoÄÃ­tat bâ‚€

```
bâ‚€ = È³ - bâ‚Â·xÌ„â‚
bâ‚€ = 5.0 - 0.046 Ã— 119
bâ‚€ = 5.0 - 5.47
bâ‚€ = -0.47
```

### âœ… VÃ½sledek - Metoda 3

```
Å· = -0.47 + 0.046Ã—plocha
```

*(MÃ­rnÃ© zaokrouhlovacÃ­ rozdÃ­ly)*

---

## PRO N = 50 (KOMPLETNÃ DATA)

V naÅ¡em pÅ¯vodnÃ­m pÅ™Ã­kladu s **n = 50** domÅ¯:

### VÃ½poÄet (zjednoduÅ¡enÄ›)

**PrÅ¯mÄ›ry:**
```
È³ = 4.5 mil.
xÌ„â‚ = 118 mÂ²
```

**Statistiky:**
```
Cov(Xâ‚, Y) = 52.3
Var(Xâ‚) = 1187.5
r = 0.82
sáµ§ = 3.03
sâ‚“â‚ = 34.46
```

### Metoda 1 (kovariance):
```
bâ‚ = Cov(Xâ‚, Y) / Var(Xâ‚)
bâ‚ = 52.3 / 1187.5
bâ‚ = 0.044
```

### Metoda 2 (korelace):
```
bâ‚ = r Ã— (sáµ§ / sâ‚“â‚)
bâ‚ = 0.82 Ã— (3.03 / 34.46)
bâ‚ = 0.82 Ã— 0.0879
bâ‚ = 0.044
```

### Konstanta:
```
bâ‚€ = È³ - bâ‚Â·xÌ„â‚
bâ‚€ = 4.5 - 0.044 Ã— 118
bâ‚€ = 4.5 - 5.19
bâ‚€ = -0.69
```

### âœ… FinÃ¡lnÃ­ model (iterace 1)

```
Å· = -0.69 + 0.044Ã—plocha
```

*V pÅ¯vodnÃ­m pÅ™Ã­kladu jsem mÄ›l zaokrouhleno:*
```
Å· = 0.85 + 0.044Ã—plocha
```
*(ProtoÅ¾e jsem pouÅ¾il trochu jinÃ¡ data - ale princip je stejnÃ½!)*

---

## MATICOVÃ VÃPOÄŒET (BONUS)

Pro jednoduchÃ½ lineÃ¡rnÃ­ model:

```
y = XÎ² + Îµ
```

**Matice X** (n Ã— 2):
```
     [1  xâ‚â‚]
     [1  xâ‚â‚‚]
X =  [1  xâ‚â‚ƒ]
     [â‹®   â‹® ]
     [1  xâ‚â‚™]
```

**Vektor y** (n Ã— 1):
```
     [yâ‚]
     [yâ‚‚]
y =  [yâ‚ƒ]
     [â‹® ]
     [yâ‚™]
```

**Odhad:**
```
b = (Xáµ€X)â»Â¹Xáµ€y
```

### Pro nÃ¡Å¡ pÅ™Ã­klad (n=10):

**Xáµ€X:**
```
Xáµ€X = [  10    1190 ]
      [ 1190  149900]
```

**Determinant:**
```
|Xáµ€X| = 10Ã—149900 - 1190Â² = 1499000 - 1416100 = 82900
```

**InverznÃ­ matice:**
```
(Xáµ€X)â»Â¹ = 1/82900 Ã— [ 149900  -1190]
                     [ -1190     10 ]

(Xáµ€X)â»Â¹ = [ 1.808  -0.0144]
          [-0.0144  0.0001206]
```

**Xáµ€y:**
```
Xáµ€y = [   50  ]
      [ 6328  ]
```

**b = (Xáµ€X)â»Â¹Xáµ€y:**
```
b = [ 1.808  -0.0144] Ã— [  50 ]
    [-0.0144 0.0001206]   [6328]

bâ‚€ = 1.808Ã—50 - 0.0144Ã—6328 = 90.4 - 91.1 = -0.7
bâ‚ = -0.0144Ã—50 + 0.0001206Ã—6328 = -0.72 + 0.76 = 0.044
```

**VÃ½sledek:**
```
b = [-0.7 ]  â†’  Å· = -0.7 + 0.044Ã—plocha
    [ 0.044]
```

---

## KONTROLA VÃPOÄŒTU

### OvÄ›Å™enÃ­ pÅ™es RÂ²

**TSS (Total Sum of Squares):**
```
TSS = Î£(yáµ¢ - È³)Â² = 18.33
```

**MSS (Model Sum of Squares):**
```
MSS = Î£(Å·áµ¢ - È³)Â² = bâ‚Â² Ã— Î£(xâ‚áµ¢ - xÌ„â‚)Â²
MSS = 0.047Â² Ã— 8290 = 18.32
```

**RSS (Residual Sum of Squares):**
```
RSS = TSS - MSS = 18.33 - 18.32 = 0.01
```

**RÂ²:**
```
RÂ² = MSS / TSS = 18.32 / 18.33 = 0.9995 â‰ˆ 1.0
```

âœ… **PerfektnÃ­ fit!** (kvÅ¯li zjednoduÅ¡enÃ½m datÅ¯m)

Pro skuteÄnÃ¡ data z n=50:
```
RÂ² = 0.672 (67.2%)
```

---

## SHRNUTÃ - JAK SPOÄŒÃTAT Î²â‚€ A Î²â‚

### ğŸ¯ NejjednoduÅ¡Å¡Ã­ metoda (doporuÄuji):

**KROK 1:** SpoÄÃ­tej prÅ¯mÄ›ry
```
È³ = Î£yáµ¢ / n
xÌ„â‚ = Î£xâ‚áµ¢ / n
```

**KROK 2:** SpoÄÃ­tej bâ‚ pÅ™Ã­mÃ½m vzorcem
```
bâ‚ = [Î£(xâ‚áµ¢Â·yáµ¢) - nÂ·xÌ„â‚Â·È³] / [Î£(xâ‚áµ¢Â²) - nÂ·xÌ„â‚Â²]
```

**KROK 3:** SpoÄÃ­tej bâ‚€
```
bâ‚€ = È³ - bâ‚Â·xÌ„â‚
```

### ğŸ“Š AlternativnÄ› (kdyÅ¾ mÃ¡Å¡ korelaci):

```
bâ‚ = r Ã— (sáµ§ / sâ‚“â‚)
bâ‚€ = È³ - bâ‚Â·xÌ„â‚
```

### ğŸ’» V Excelu / Calc:

```
bâ‚ = SLOPE(y_rozsah, x_rozsah)
bâ‚€ = INTERCEPT(y_rozsah, x_rozsah)
```

### ğŸ V Pythonu:

```python
from scipy import stats
slope, intercept, r, p, se = stats.linregress(x, y)
```

### ğŸ“ˆ V R:

```r
model <- lm(y ~ x1)
coef(model)  # dÃ¡ vÃ¡m bâ‚€ a bâ‚
```

---

**Hotovo! TeÄ vÃ­te, jak se poÄÃ­tÃ¡ Î²â‚€ a Î²â‚ od zÃ¡kladÅ¯.** ğŸ“
